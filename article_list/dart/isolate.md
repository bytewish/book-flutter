

# 简介

Dart运行时是单线程的，单线程指的是只有一个执行线程在处理所有的任务和数据，比如`shell脚本`，它可以保证执行顺序。但Dart提供了`Isolate`，可以在同一个进程中创建多个`Isolate`，每个`Isolate`具有独立的上下文、内存、调用堆栈，可以执行不同的任务和事件，因此不同的`Isolate`可以执行不同的代码，相互不会干扰。虽然`Isolate`与线程相似，但他们不能共享内存，只能通过消息传递来通信，实际上每个`Isolate`内部仍旧是单线程的，也就是说内部仍旧是按顺序执行。



# Isolate

`Isolate`可以理解为`dart`程序的运行环境或者容器，每个`Isolate`都有自己独立的一套内存、代码，它们之间可以通过消息通讯的方式来实现通讯。举个例子，当我想做耗时操作比如网络请求的时候，我可以新开`Isolate`，反正它也不需要我的环境，用它自身环境就行，获取数据回来之后再通过消息通讯的方式发给我就行了。

在Flutter应用程序在启动的时候，会默认启动一个主线程`Root isolate`，我们还可以自己创建更多的`isolate`。比如使用`foundation`库中封装的`compute`来开启一个简单的`isolate`运行耗时代码，完成操作之后再通过消息通讯的方式返回消息。



# 异步

Flutter应用程序启动的时候，会启动一个主线程`Root isolate`，在这个`isolate`中会运行一个`EventLoop`事件循环队列，可以理解为一个用`while(true)`死循环遍历的消息队列，拿到操作就去执行。异步就是通过这个`EventLooper`来实现的，只不过它用上了任务调度，也就是分开执行某些代码片段来实现。对于这种方式来说，执行耗时操作仍旧会卡死。



